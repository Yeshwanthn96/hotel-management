<div class="container" *ngIf="!loading && stats">
  <h1 style="text-align: center; margin-bottom: 30px;">Dashboard</h1>

  <!-- Key Metrics Cards -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div class="card" style="text-align: center; padding: 25px;">
      <h3 style="color: #666; font-size: 14px; margin: 0;">Total Revenue</h3>
      <p style="font-size: 32px; font-weight: bold; color: #28a745; margin: 10px 0;">{{formatCurrency(stats.totalRevenue)}}</p>
    </div>
    
    <div class="card" style="text-align: center; padding: 25px;">
      <h3 style="color: #666; font-size: 14px; margin: 0;">Total Bookings</h3>
      <p style="font-size: 32px; font-weight: bold; color: #007bff; margin: 10px 0;">{{stats.totalBookings}}</p>
    </div>
    
    <div class="card" style="text-align: center; padding: 25px;">
      <h3 style="color: #666; font-size: 14px; margin: 0;">Average Occupancy</h3>
      <p style="font-size: 32px; font-weight: bold; color: #ffc107; margin: 10px 0;">{{formatPercent(stats.averageOccupancy)}}</p>
    </div>
    
    <div class="card" style="text-align: center; padding: 25px;">
      <h3 style="color: #666; font-size: 14px; margin: 0;">Avg Booking Amount</h3>
      <p style="font-size: 32px; font-weight: bold; color: #17a2b8; margin: 10px 0;">{{formatCurrency(stats.averageBookingAmount)}}</p>
    </div>
  </div>

  <!-- Booking Status -->
  <div class="card" style="margin-bottom: 30px;">
    <h2 class="card-title">Booking Status</h2>
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">
      <div>
        <h4>Confirmed</h4>
        <p style="font-size: 24px; font-weight: bold; color: #28a745;">{{stats.confirmedBookings}}</p>
      </div>
      <div>
        <h4>Completed</h4>
        <p style="font-size: 24px; font-weight: bold; color: #007bff;">{{stats.completedBookings}}</p>
      </div>
      <div>
        <h4>Cancelled</h4>
        <p style="font-size: 24px; font-weight: bold; color: #dc3545;">{{stats.cancelledBookings}}</p>
      </div>
    </div>
  </div>

  <!-- Top Revenue Hotels -->
  <div class="card" style="margin-bottom: 30px;">
    <h2 class="card-title">Top Hotels by Revenue</h2>
    <table>
      <thead>
        <tr>
          <th>Hotel ID</th>
          <th>Revenue</th>
          <th>Occupancy Rate</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let hotel of stats.topRevenueHotels">
          <td>{{hotel.key}}</td>
          <td style="color: #28a745; font-weight: bold;">{{formatCurrency(hotel.value)}}</td>
          <td>
            <span *ngIf="stats.occupancyRates[hotel.key]">
              {{formatPercent(stats.occupancyRates[hotel.key])}}
            </span>
            <span *ngIf="!stats.occupancyRates[hotel.key]">N/A</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Top Rated Hotels -->
  <div class="card" style="margin-bottom: 30px;">
    <h2 class="card-title">Top Rated Hotels</h2>
    <table>
      <thead>
        <tr>
          <th>Hotel ID</th>
          <th>Rating</th>
          <th>Stars</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let hotel of stats.topRatedHotels">
          <td>{{hotel.key}}</td>
          <td style="font-weight: bold; color: #ffc107;">{{hotel.value.toFixed(1)}}/5.0</td>
          <td>
            <span style="color: #ffc107; font-size: 18px;">
              {{'‚≠ê'.repeat(Math.floor(hotel.value))}}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Revenue by Hotel -->
  <div class="card">
    <h2 class="card-title">Revenue Distribution by Hotel</h2>
    <div *ngFor="let hotelId of getObjectKeys(stats.revenueByHotel)" style="margin-bottom: 15px;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
        <span>{{hotelId}}</span>
        <span style="font-weight: bold; color: #28a745;">{{formatCurrency(stats.revenueByHotel[hotelId])}}</span>
      </div>
      <div style="background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden;">
        <div style="background: #28a745; height: 100%;" 
             [style.width.%]="(stats.revenueByHotel[hotelId] / stats.totalRevenue) * 100">
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container" *ngIf="loading" style="text-align: center; padding: 100px;">
  <h2>Loading Dashboard...</h2>
</div>

<div class="container" *ngIf="!loading && !stats" style="text-align: center; padding: 100px;">
  <h2>Failed to load dashboard data</h2>
  <button (click)="loadDashboard()" class="btn btn-primary">Retry</button>
</div>
