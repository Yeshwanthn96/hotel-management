<div class="auth-container">
  <div class="auth-card">
    <button class="close-btn" (click)="close()">&times;</button>
    
    <h2 class="auth-title">Change Password</h2>
    <p class="auth-subtitle">Update your account password</p>

    <div *ngIf="errorMessage" class="alert alert-error">
      {{ errorMessage }}
    </div>

    <div *ngIf="successMessage" class="alert alert-success">
      {{ successMessage }}
    </div>

    <form (ngSubmit)="changePassword()">
      <div class="form-group">
        <label for="oldPassword">Current Password</label>
        <div class="password-input-wrapper">
          <input 
            [type]="showOldPassword ? 'text' : 'password'" 
            id="oldPassword" 
            [(ngModel)]="oldPassword" 
            name="oldPassword"
            placeholder="Enter current password"
            [disabled]="isLoading"
            required>
          <button type="button" class="toggle-password" (click)="toggleOldPasswordVisibility()">
            <span *ngIf="!showOldPassword">ğŸ‘ï¸</span>
            <span *ngIf="showOldPassword">ğŸ™ˆ</span>
          </button>
        </div>
      </div>

      <div class="form-group">
        <label for="newPassword">New Password</label>
        <div class="password-input-wrapper">
          <input 
            [type]="showNewPassword ? 'text' : 'password'" 
            id="newPassword" 
            [(ngModel)]="newPassword" 
            name="newPassword"
            (input)="onPasswordChange()"
            placeholder="Enter new password"
            [disabled]="isLoading"
            required>
          <button type="button" class="toggle-password" (click)="toggleNewPasswordVisibility()">
            <span *ngIf="!showNewPassword">ğŸ‘ï¸</span>
            <span *ngIf="showNewPassword">ğŸ™ˆ</span>
          </button>
        </div>
        
        <!-- Password Strength Indicator -->
        <div *ngIf="newPassword" class="password-strength">
          <div class="strength-bar">
            <div class="strength-fill" 
                 [style.width.%]="passwordStrength.percentage"
                 [style.background-color]="passwordStrength.color"></div>
          </div>
          <span [style.color]="passwordStrength.color">{{ passwordStrength.strength }}</span>
        </div>

        <!-- Password Requirements -->
        <ul *ngIf="newPassword && passwordErrors.length > 0" class="password-errors">
          <li *ngFor="let error of passwordErrors">{{ error }}</li>
        </ul>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm New Password</label>
        <input 
          type="password" 
          id="confirmPassword" 
          [(ngModel)]="confirmPassword" 
          name="confirmPassword"
          placeholder="Confirm your new password"
          [disabled]="isLoading"
          required>
      </div>

      <button type="submit" class="btn btn-primary" [disabled]="isLoading || !oldPassword || !newPassword || !confirmPassword">
        <span *ngIf="!isLoading">Change Password</span>
        <span *ngIf="isLoading">Changing...</span>
      </button>

      <div class="auth-links">
        <a (click)="close()" style="cursor: pointer;">Cancel</a>
      </div>
    </form>
  </div>
</div>
